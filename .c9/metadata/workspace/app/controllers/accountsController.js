{"filter":false,"title":"accountsController.js","tooltip":"/app/controllers/accountsController.js","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":0,"column":0},"end":{"row":0,"column":39}},"text":"var locomotive = require('locomotive');"},{"action":"insertText","range":{"start":{"row":0,"column":39},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":1,"column":0},"end":{"row":53,"column":0}},"lines":["var passport = require('passport');","var Controller = locomotive.Controller;","","var Account = require('../models/account');","","var AccountController = new Controller();","","AccountController.show = function() {","  if (!this.req.isAuthenticated())","    return this.res.redirect(this.urlFor({ action: 'login' }));","","  this.user = this.req.user;","  this.render();","};","","AccountController.new = function() {","  this.render();","};","","AccountController.loginForm = function() {","  this.render();","};","","AccountController.create = function() {","  var account = new Account();","","  account.email = this.param('email');","  account.password = this.param('password');","  account.name.first = this.param('name.first');","  account.name.last = this.param('name.last');","","  var self = this;","  account.save(function (err) {","    if (err)","      return self.redirect(self.urlFor({ action: 'new' }));","","    return self.redirect(self.urlFor({ action: 'login' }));","  });","};","","AccountController.login = function() {","  passport.authenticate('local', {","    successRedirect: this.urlFor({ action: 'show' }),","    failureRedirect: this.urlFor({ action: 'login' }) }","  )(this.__req, this.__res, this.__next);","};","","AccountController.logout = function() {","  this.req.logout();","  this.redirect('/');","};",""]},{"action":"insertText","range":{"start":{"row":53,"column":0},"end":{"row":53,"column":35}},"text":"module.exports = AccountController;"}]}]]},"ace":{"folds":[],"scrolltop":456,"scrollleft":0,"selection":{"start":{"row":36,"column":0},"end":{"row":36,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":27,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1407883386174,"hash":"07030db7a70ff66ed1295a593d6bd71ef66d6389"}